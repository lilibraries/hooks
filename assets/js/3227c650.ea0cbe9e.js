"use strict";(self.webpackChunk_lilib_hooks=self.webpackChunk_lilib_hooks||[]).push([[6221],{7480:(e,n,t)=>{t.d(n,{Z:()=>d});var r=t(7294),o=t(2991),a=t.n(o),i=t(2082),l=t(4708),u=t(6937),s=t(8042),c=t(4259),f=t(2641);const d=function(e){return function(n,t){void 0===t&&(t={});const{defaultValue:o,serialize:d,deserialize:p,polling:m=!1,pollingInterval:g=100}=t;function v(){try{const t=null==e?void 0:e.getItem(n);if(null!=t)return function(e){return p?p(e):JSON.parse(e)}(t)}catch(t){console.error(t)}return o}const[k,N]=(0,s.Z)(v),Z=(0,l.Z)((t=>{N((r=>{if(void 0===(t=(0,f.Z)(t)?t(r):t))return null==e||e.removeItem(n),o;try{null==e||e.setItem(n,function(e){return d?d(e):JSON.stringify(e)}(t))}catch(a){console.error(a)}return t}))})),S=()=>{const e=v();a()(e,k)||N(e)},[y,h]=(0,u.Z)(S,g);return(0,r.useEffect)((()=>{h(),m&&y()}),[m]),(0,c.Z)((()=>window),"storage",S),(0,i.Z)((()=>{h(),N(v()),m&&y()}),[n]),(0,i.Z)((()=>{null!=(null==e?void 0:e.getItem(n))||a()(o,k)||N(o)}),[o]),[k,Z]}}},3724:(e,n,t)=>{t.d(n,{Z:()=>l});var r=t(7294),o=t(8134);const a=function(e,n){if(e===n)return!0;if(e.length!==n.length)return!1;let t=0,r=e.length;for(;t<r;t++)if(!Object.is(e[t],n[t]))return!1;return!0};var i=t(7541);const l=function(e){return function(n,t,l){const u=(0,r.useRef)(!1),s=(0,r.useRef)([]),c=(0,r.useRef)([]),f=(0,r.useRef)();function d(){null==f.current||f.current()}e((()=>{const e=l.map(i.Z);function r(){s.current=t,c.current=e,f.current=n()}u.current?a(t,s.current)&&a(e,c.current)||(d(),r()):(r(),u.current=!0)})),(0,o.Z)((()=>{d(),u.current=!1}))}}},4259:(e,n,t)=>{t.d(n,{Z:()=>u});var r=t(4708),o=t(3809),a=t(8298),i=t(7541);const l=function(e){return!!e&&!!e.addEventListener&&!!e.removeEventListener};const u=function(e,n,t,u){let s,c,f;"boolean"==typeof u?s=u:(0,a.Z)(u)&&(void 0!==u.capture&&(s=!!u.capture),void 0!==u.once&&(c=!!u.once),void 0!==u.passive&&(f=!!u.passive));const d=(0,r.Z)(t);(0,o.Z)((()=>{const t=(0,i.Z)(e);if(l(t))return t.addEventListener(n,d,{capture:s,once:c,passive:f}),()=>{t.removeEventListener(n,d,{capture:s})}}),[n,s,c,f],[e])}},6937:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(9051);const o=function(e,n){const[t,o]=(0,r.Z)((()=>{e(),t()}),n);return[t,o]}},8242:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(7294);const o=function(e){const n=(0,r.useRef)(e);return n.current=e,n}},4708:(e,n,t)=>{t.d(n,{Z:()=>a});var r=t(7294),o=t(8242);const a=function(e){const n=(0,r.useRef)(),t=(0,o.Z)(e);return n.current||(n.current=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.current.apply(this,n)}),n.current}},8042:(e,n,t)=>{t.d(n,{Z:()=>i});var r=t(7294),o=t(4708);const a=function(){const e=(0,r.useRef)(!1);return(0,r.useEffect)((()=>(e.current=!1,()=>{e.current=!0})),[]),e};const i=function(e){const n=a(),[t,i]=(0,r.useState)(e);return[t,(0,o.Z)((e=>{n.current||i(e)}))]}},3809:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(7294);const o=(0,t(3724).Z)(r.useEffect)},9051:(e,n,t)=>{t.d(n,{Z:()=>i});var r=t(7294),o=t(8134),a=t(4708);const i=function(e,n){const t=(0,a.Z)(e),i=(0,r.useRef)(),l=(0,a.Z)((()=>{void 0!==i.current&&(clearTimeout(i.current),i.current=void 0)})),u=(0,a.Z)((()=>{l(),i.current=setTimeout(t,n)}));return(0,o.Z)(l),[u,l]}},8134:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(7294);const o=function(e){const n=(0,r.useRef)(e);n.current=e,(0,r.useEffect)((()=>()=>{n.current()}),[])}},2082:(e,n,t)=>{t.d(n,{Z:()=>a});var r=t(7294),o=t(8134);const a=function(e){return function(n,t){const a=(0,r.useRef)(!1);e((()=>{if(a.current)return n();a.current=!0}),t),(0,o.Z)((()=>{a.current=!1}))}}(r.useEffect)},7541:(e,n,t)=>{t.d(n,{Z:()=>i});var r=t(9745),o=t(8298),a=t(2641);const i=function(e){return r.Z?(0,a.Z)(e)?e():(0,o.Z)(e)&&"current"in e?e.current:e:null}},9745:(e,n,t)=>{t.d(n,{Z:()=>r});const r=!("undefined"==typeof window||!window.document||!window.document.createElement)},2641:(e,n,t)=>{t.d(n,{Z:()=>r});const r=function(e){return"function"==typeof e}},8298:(e,n,t)=>{t.d(n,{Z:()=>r});const r=function(e){return"object"==typeof e&&null!==e}},5748:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>m,contentTitle:()=>d,default:()=>k,frontMatter:()=>f,metadata:()=>p,toc:()=>g});var r=t(7462),o=t(7294),a=t(3905),i=t(3066),l=t(2823),u=t(9745);const s=(0,t(7480).Z)(u.Z?localStorage:null);const c=function(){const[e,n]=s("key",{polling:!0,defaultValue:"default value"});return o.createElement(o.Fragment,null,o.createElement("div",null,o.createElement("button",{onClick:()=>n(Math.random().toString())},"Set random value")," ",o.createElement("button",{onClick:()=>n(void 0)},"Remove")),o.createElement("div",null,"The value is: ",e))},f={},d=void 0,p={unversionedId:"useLocalStorage",id:"useLocalStorage",title:"useLocalStorage",description:"Get, set and/or remove localStorage.",source:"@site/docs/useLocalStorage.mdx",sourceDirName:".",slug:"/useLocalStorage",permalink:"/hooks/useLocalStorage",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"useCookie",permalink:"/hooks/useCookie"},next:{title:"useSessionStorage",permalink:"/hooks/useSessionStorage"}},m={},g=[{value:"API",id:"api",level:2},{value:"Example",id:"example",level:2}],v={toc:g};function k(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,r.Z)({},v,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Get, set and/or remove ",(0,a.kt)("inlineCode",{parentName:"p"},"localStorage"),"."),(0,a.kt)("h2",{id:"api"},"API"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"function useLocalStorage<T>(\n  key: string,\n  options: {\n    defaultValue: T;\n    polling?: boolean;\n    pollingInterval?: number;\n    serialize?: (value: T) => string;\n    deserialize?: (value: string) => T;\n  }\n): readonly [\n  value: T,\n  setLocalStorage: (\n    newValue: T | undefined | ((prevValue: T) => T | undefined)\n  ) => void\n];\n\nfunction useLocalStorage<T>(\n  key: string,\n  options?: {\n    defaultValue?: T;\n    polling?: boolean;\n    pollingInterval?: number;\n    serialize?: (value: T) => string;\n    deserialize?: (value: string) => T;\n  }\n): readonly [\n  value: T | undefined,\n  setLocalStorage: (\n    newValue: T | undefined | ((prevValue: T | undefined) => T | undefined)\n  ) => void\n];\n")),(0,a.kt)("p",null,"Params:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"strong"},"key"),":")," ",(0,a.kt)("inlineCode",{parentName:"li"},"localStorage")," key."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"strong"},"options"),":")," Options object.",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"strong"},"options.defaultValue"),":")," Default value."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"strong"},"options.polling"),":")," Pollingly update value. Default is ",(0,a.kt)("inlineCode",{parentName:"li"},"false"),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"strong"},"options.pollingInterval"),":")," Polling interval time, in milliseconds. Default is ",(0,a.kt)("inlineCode",{parentName:"li"},"100"),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"strong"},"options.serialize"),":")," Serialization function. Default is ",(0,a.kt)("inlineCode",{parentName:"li"},"JSON.stringify"),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"strong"},"options.deserialize"),":")," Deserialization function. Default is ",(0,a.kt)("inlineCode",{parentName:"li"},"JSON.parse"),".")))),(0,a.kt)("p",null,"Results:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"strong"},"value"),":")," Parsed by the deserialization function."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"strong"},"setLocalStorage"),":")," Set ",(0,a.kt)("inlineCode",{parentName:"li"},"localStorage"),". If the ",(0,a.kt)("inlineCode",{parentName:"li"},"newValue")," is ",(0,a.kt)("inlineCode",{parentName:"li"},"undefined"),", return the ",(0,a.kt)("inlineCode",{parentName:"li"},"defaultValue"),".")),(0,a.kt)("h2",{id:"example"},"Example"),(0,a.kt)(l.Z,{mdxType:"ExampleBlock"},(0,a.kt)(c,{mdxType:"Example"})),(0,a.kt)(i.Z,{language:"tsx",mdxType:"CodeBlock"},'import React from "react";\nimport { useLocalStorage } from "@lilib/hooks";\n\nfunction Example() {\n  const [value, setLocalStorage] = useLocalStorage("key", {\n    polling: true,\n    defaultValue: "default value",\n  });\n\n  return (\n    <>\n      <div>\n        <button onClick={() => setLocalStorage(Math.random().toString())}>\n          Set random value\n        </button>{" "}\n        <button onClick={() => setLocalStorage(undefined)}>Remove</button>\n      </div>\n      <div>The value is: {value}</div>\n    </>\n  );\n}\n\nexport default Example;\n'))}k.isMDXComponent=!0},2991:e=>{e.exports=function e(n,t){if(n===t)return!0;if(n&&t&&"object"==typeof n&&"object"==typeof t){if(n.constructor!==t.constructor)return!1;var r,o,a;if(Array.isArray(n)){if((r=n.length)!=t.length)return!1;for(o=r;0!=o--;)if(!e(n[o],t[o]))return!1;return!0}if(n instanceof Map&&t instanceof Map){if(n.size!==t.size)return!1;for(o of n.entries())if(!t.has(o[0]))return!1;for(o of n.entries())if(!e(o[1],t.get(o[0])))return!1;return!0}if(n instanceof Set&&t instanceof Set){if(n.size!==t.size)return!1;for(o of n.entries())if(!t.has(o[0]))return!1;return!0}if(ArrayBuffer.isView(n)&&ArrayBuffer.isView(t)){if((r=n.length)!=t.length)return!1;for(o=r;0!=o--;)if(n[o]!==t[o])return!1;return!0}if(n.constructor===RegExp)return n.source===t.source&&n.flags===t.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===t.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===t.toString();if((r=(a=Object.keys(n)).length)!==Object.keys(t).length)return!1;for(o=r;0!=o--;)if(!Object.prototype.hasOwnProperty.call(t,a[o]))return!1;for(o=r;0!=o--;){var i=a[o];if(!e(n[i],t[i]))return!1}return!0}return n!=n&&t!=t}}}]);